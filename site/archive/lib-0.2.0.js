(()=>{var h=Symbol(),m=Symbol(),S=()=>`_${y(crypto.randomUUID())}`,y=r=>r.replace(/-+(\w)?/g,(t,e="")=>e?.toUpperCase()),N=r=>r.replace(/[A-Z]/g,"-$&").toLowerCase(),C=r=>{let t={constructor:null};for(let e of r)for(let o of Object.keys(e))t[o]??=function(...n){r.map(c=>c[o]?.call(this,...n))};return t};var g=class{#t=[];#o=[];#e;#n;#r;constructor(t){u.add("undo",()=>this.stop()),t?.((...e)=>{this.now(...e)})}flow(t){return this.#t.push(t),this}now(...t){let e=-1,o=()=>{this.#e||(e++,!(e<this.#r)&&(this.#n&&(this.#r=e+1),this.#t.length+1==this.#r&&this.stop(),this.#t[e]?.(o,...t)))};return o(),this}then(t){return this.flow((e,...o)=>{t(...o),e()})}await(t){return this.flow(async(e,...o)=>{await t(...o),e()})}if(t){return this.flow((e,...o)=>{t(...o)&&e()})}or(t){return t.then((...e)=>this.now(...e)),this.cleanup(()=>t.stop?.())}stop(){if(!this.#e)return this.#e=!0,this.#t.splice(0),this.#o.splice(0).map(t=>t()),this}until(t){return typeof t=="function"?this.flow((e,...o)=>t(...o)?this.stop():e()):(this.cleanup(()=>t.stop?.()),t.then(()=>this.stop()),this)}cleanup(t){return this.#e?t():this.#o.push(t),this}once(){return this.then(()=>this.#n=!0)}debounce(t){let e;return this.flow(o=>{clearTimeout(e),e=setTimeout(o,t)}).cleanup(()=>clearTimeout(e))}throttle(t){let e,o;return this.flow(n=>{if(o)return e=n;n(),o=setInterval(()=>{if(!e){clearTimeout(o),o=0;return}e(),e=null},t)}).cleanup(()=>clearTimeout(o))}after(t){return queueMicrotask(()=>queueMicrotask(t)),this}};var d=(...r)=>new Proxy({does:(t,e)=>{let o;return new g(n=>{o=n,r.map(c=>c.addEventListener(t,o,e))}).cleanup(()=>r.map(n=>n.removeEventListener(t,o,e)))},observes:(t,e)=>{let o;return new g(n=>{o=new self[y(`-${t}-observer`)](n,e),r.map(c=>o.observe(c,e))}).cleanup(()=>o.disconnect())}},{get:(t,e)=>t[e]??t.does.bind(null,e.replace(/s$/,""))});var w=(r,t=queueMicrotask)=>{let e,o=new g;return o.then(()=>{let n=u(["live","undo"],r);e=u.ignore(()=>d(n.live).change()).once().then(()=>t(()=>o.now())).cleanup(()=>n.undo())}).cleanup(()=>e?.stop()),t(()=>o.now()),o};var p=r=>new E({t:{$:p.get(r)}},"$").e;p[m]=new WeakMap;var M=new WeakMap,E=class{constructor(t,e,o=this){this.r=t,this.c=e,this.h=o,this.a={},this.e=new Proxy(new EventTarget,{get:(n,c)=>c==Symbol.iterator?()=>(u.add("live",this.e,"keychange"),[...this.t].map((i,s)=>this.o(s).e)[Symbol.iterator]()):c[0]=="$"?this.o(c.slice(1)).e:n[c]?n[c].bind(n):(u.add("live",this.o(c).e,"deepchange"),this.t?.[c]),set:(n,c,i)=>p.set(this.o(c).e,i),deleteProperty:(n,c,i)=>p.delete(this.o(c).e),has:(n,c)=>(u.add("live",this.e,"keychange"),this.t!=null&&n[c]||c in this.t),ownKeys:()=>(u.add("live",this.e,"keychange"),Object.keys(this.t??{}).map(n=>`$${n}`)),getOwnPropertyDescriptor:()=>({configurable:!0,enumerable:!0}),defineProperty:()=>!1}),p[m].set(this.e,this),o==this&&M.set(this,new Set),M.get(o).add(new WeakRef(this)),this.t=this.r.t?.[this.c],this.m=Object.keys(this.t??{})}o(t){return this.a[t]??=new E(this,t,this.h)}l(t,e=new Set([this])){let o=t?.(),n=this.t,c=this.r.t?.[this.c];this.t=c,Object.is(n,c)||this.e.dispatchEvent(new CustomEvent("change",{detail:{oldValue:n,value:c}}));let i=Object.keys(this.t??{}),s=new Set(this.m);this.m=i;for(let f of i)s.has(f)?s.delete(f):s.add(f);s.size&&this.e.dispatchEvent(new CustomEvent("keychange",{detail:{keys:[...s]}}));let l=this.r;for(e.add(this);!e.has(l)&&l.r;)l.l(null,e),e.add(l),l=l.r;if(Object.is(n,c))return o;for(let f of Object.values(this.a))f.l(null,e);if(t){for(let f of e)f.e.dispatchEvent(new CustomEvent("deepchange"));return o}}};p.get=(r,t)=>{let e=p[m].get(r);return e?t!=null?e.o(t).t:(u.add("live",r,"deepchange"),e.t):t==null?r:r[t]};p.set=(r,t)=>{let e=p[m].get(r);return!!e?.l(()=>e.r.t==null?!1:(e.r.t[e.c]=p.get(t),!0))};p.delete=(r,t)=>{let e=p[m].get(r);return!!e?.l(()=>e.r.t==null?!1:delete e.r.t[e.c])};p.link=(r,t)=>{let e,o=t;t instanceof HTMLElement?o={get:()=>t.value,set:s=>t.value=s,changes:d(t).input()}:typeof t=="function"&&(o={get:()=>e,changes:w(()=>e=t(),s=>s())});let n,c=s=>{n=!0,p.set(r,s),e=s,n=!1},i=d(r).deepchange().then(()=>{if(!n){if(!o.set)return c(e);o.set(u.ignore(()=>p.get(r))),c(u.ignore(o.get))}});return c(u.ignore(o.get)),(o.changes??new g).then(()=>c(u.ignore(o.get))).if(()=>null).cleanup(()=>i.stop())};var u=(r,t)=>{let e=u[h];u[h]={};let o={};for(let n of r)o[n]=(u[h][n]=new u[m][n]).result;return o.result=t(),u[h]=e,o},j=r=>{if(!u[h])return r;let t=u[h];return u[h]=null,{then:e=>Promise.resolve(r).then(o=>{Object.keys(t).some(n=>t[n].until?.())||(queueMicrotask(()=>u[h]=t),e(o),queueMicrotask(()=>u[h]=null))})}};u.ignore=r=>u([],r).result;u.add=(r,...t)=>{u[h]?.[r]?.add(...t)};u[m]={result:!0};u.register=(r,t)=>{u[m][r]||(u[m][r]??=t)};u.register("undo",class{[m]=[];#t;result=()=>{this.#t||(this[m].splice(0).map(r=>r()),this.#t=!0)};add(r){if(this.#t)return r();this[m].push(r)}until(){return this.#t}});u.register("live",class{[m]=new Map;result=new EventTarget;add(r,t){let e=this[m].get(r)??[];e.includes(t)||(e.push(t),this[m].set(r,e),u.ignore(()=>d(r).does(t)).then(()=>this.result.dispatchEvent(new CustomEvent("change"))))}});var F=r=>{let t;return(...e)=>(t?.undo(),t=u(["undo"],()=>r(...e)),t.result)};var O=r=>{let t;return new g(e=>t=setInterval(e,r)).cleanup(()=>clearInterval(t))},L=r=>O(r).once(),q=()=>{let r;return new g(t=>{let e=()=>r=requestAnimationFrame(o=>{e(),t(o)});e()}).cleanup(()=>cancelAnimationFrame(r))},P=()=>{let r=0;return q().if(()=>r++).once()};var a=r=>{let t={x:new Set,i:new WeakMap,s:class extends HTMLElement{constructor(){super(),t.i.set(this,{x:{}}),u.ignore(()=>n.constructor.call(this,t.i.get(this)))}}},e={};r(Object.fromEntries(a[m].map(([c,i])=>[i,(...s)=>(e[i]??=[]).push(s)])));let o=a[m].map(([c,i])=>c(t,e[i]??[])),n=C(o);for(let c of Object.keys(n))t.s.prototype[c]??=function(...i){u.ignore(()=>n[c].call(this,t.i.get(this),...i))};return customElements.define(t.p,t.s),customElements.whenDefined(t.p)};a[m]=[];a[h]=[];a.register=(r,t,e)=>{a[m].push([e,t,r]),a[m].sort((o,n)=>o[2]-n[2])};a.transform=(r,t)=>{a[h].push([t,r]),a[h].sort((e,o)=>e[1]-o[1])};var k=async r=>{if(k[m].has(r))return;k[m].add(r);let t=await fetch(r);if(!t.ok)return;let e=S(),o=S(),n=document.createElement("template");return n.innerHTML=await t.text(),a(c=>{for(let i of n.content.children)c[i.localName]?.(Object.fromEntries([...i.attributes].map(s=>[y(s.name),s.value])),i.innerHTML)})};k[m]=new Set;var T,I;k.auto=r=>{if(T)return;T=new Set;let t=o=>{if(T.has(o))return;T.add(o);let n=r(o);n&&k(n)},e=o=>{for(let n of o.querySelectorAll(":not(:defined)"))t(n.localName);for(let n of o.querySelectorAll("template"))e(n.content)};return a.register(6,null,o=>I?{}:o.u?(e(o.u),{}):{},{}),d(document).observes("mutation",{childList:!0,subtree:!0}).then(()=>e(document)).now().if(()=>null).cleanup(()=>I=!0)};a.register(0,"title",(r,[t])=>(r.p=t?.[1],{}));a.register(1,"meta",(r,t)=>{r.x.add("$");let e=t.filter(i=>i[0].attribute),o=[...t.filter(i=>i[0].property),...e.filter(i=>i[0].type).map(i=>[{property:i[0].as??y(i[0].attribute)}]),...t.filter(i=>i[0].method).map(i=>[{property:i[0].method,readonly:""}])];for(let[i]of o){let s=function(){return u.ignore(()=>p.get(r.i.get(this).x.$,i.property))},l=function(f){u.ignore(()=>r.i.get(this).x.$[i.property]=f)};Object.defineProperty(r.s.prototype,i.property,"readonly"in i?{get:s}:{get:s,set:l})}return r.s.observedAttributes=e.map(i=>i[0].attribute),r.s.formAssociated=t.some(i=>i[0].formAssociated!=null),{constructor:function(i){i.x.$=p({attributes:{}}),i.x.$.attributes={};for(let[s]of e){let l=y(s.attribute);if(i.x.$.$attributes[l]=null,d(i.x.$.$attributes[`$${l}`]).change().then(()=>{let f=p.get(i.x.$.$attributes,l);f==null?this.removeAttribute(s.attribute):this.setAttribute(s.attribute,f)}),s.type=="boolean")p.link(i.x.$[`$${s.as??l}`],{get:()=>p.get(i.x.$.$attributes,l)!=null,set:f=>i.x.$.$attributes[l]=f?"":null,changes:d(i.x.$.$attributes[`$${l}`]).change()});else if(s.type){let f=self[y(`-${s.type}`)];p.link(i.x.$[`$${s.as??l}`],{get:()=>f(p.get(i.x.$.$attributes,l)??s.default??""),set:v=>i.x.$.$attributes[l]=v==null?null:`${v}`,changes:d(i.x.$.$attributes[`$${l}`]).change()})}}for(let[{property:s}]of o){if(!Object.hasOwn(this,s))continue;let l=this[s];delete this[s],this[s]=l}},attributeChangedCallback:function(i,s,l,f){i.x.$.$attributes[y(s)]=f}}});a.register(2,"meta",(r,t)=>C([...t,[{hook:"connected",unhook:"disconnected"}],[{hook:"disconnected"}]].filter(e=>e[0].hook).map(e=>{let{hook:o,unhook:n}=e[0];r.x.add(o);let c=function(s){s.x[o]=l=>{let f=[new g().then((...v)=>{f[1]?.undo(),f[1]=u(["undo"],()=>l?.(...v))}).cleanup(()=>{f[1]?.undo(),s.x[o][m].delete(f)})];return s.x[o][m].add(f),s.x[o][h]&&queueMicrotask(()=>f[0].now(...s.x[o][h])),f[0]},s.x[o][m]=new Set},i=function(s,...l){s.x[o][h]=l;for(let f of s.x[o][m])f[0].now(...l)};return n?{constructor:c,[`${o}Callback`]:i,[`${n}Callback`]:function(s,...l){s.x[o][h]=null;for(let f of s.x[o][m])f[1]?.undo()}}:{constructor:c,[`${o}Callback`]:i}})));a.register(3,Symbol(),r=>({constructor:function(e){e.n=(o,...n)=>{let c=n.map(()=>S()),i=new Function(...c,`var ${n.map((s,l)=>`${s[0]}=${c[l]}`)};return(${o})`);return(s,...l)=>i.call(s,...l.map(f=>f[1]))},e.f=(o,...n)=>u.ignore(()=>{let c=o.cloneNode(!0),i=document.createNodeIterator(c,5),s;t:for(;s=i.nextNode();){if(s.nodeType==1){for(let[l]of a[h])for(let f of[...s.attributes])if(l(f,n,e,r),i.referenceNode!=s)continue t}for(let[l]of a[h])if(l(s,n,e,r),i.referenceNode!=s)continue t}return c})}}));a.register(5,"template",(r,[t])=>{if(!t)return{constructor:function(i){i.root=this}};let e=document.createElement("template");return e.innerHTML=t[1],r.u=e.content,t[0].mode?{constructor:function(i){i.root=this.attachShadow(t[0]),i.root.append(i.f(r.u,[`{${[...r.x]}}`,i.x])),customElements.upgrade(i.root)}}:{constructor:function(c){c.root=c.f(r.u,[`{${[...r.x]}}`,c.x]),customElements.upgrade(c.root)},connectedCallback:function(c){this.replaceChildren(c.root),c.root=this}}});a.register(7,Symbol(),r=>(r.x.add("elements"),{constructor:function(e){let o={all:n=>[...e.root.querySelectorAll(n)],shadow:e.root.mode?e.root:null};e.x.elements=new Proxy(n=>e.root.querySelector(n),{get:(n,c)=>o[c]??=n(`#${N(c)},#${c}`)??n(N(c))})}}));a.register(8,"style",(r,[t])=>{if(!t)return{};let e=new CSSStyleSheet;return e.replace(t[1]),{connectedCallback:function(n){let c=n.x.elements.shadow??this.getRootNode(),i=c.adoptedStyleSheets;i.includes(e)||(c.adoptedStyleSheets=[...i,e])}}});a.register(10,"script",(r,[t])=>{if(!t)return{};let e=new Function(`{${[...r.x]}}`,`const{${Object.keys(self.yozo)}}=self.yozo;${t[1]}`);return{constructor:function(n){e.call(this,n.x)}}});a.transform(0,(r,t,e,o)=>{if(r.nodeType!=3)return;let n=r.textContent.split(/{{([^]*?)}}/g);r.before(...n);let c=r;for(let i=1;i<n.length;i+=2){c=c.previousSibling.previousSibling;let s=c,l=e.n(s.textContent,...t);e.x.connected(()=>w(()=>{s.textContent=l(null,...t)}))}r.remove()});a.transform(1,(r,t,e,o)=>{if(r.nodeType!=2||r.name!="#for")return;let n=r.ownerElement;n.removeAttribute(r.name);let[c,i]=r.value.split(" of ");n.before("");let s=n.previousSibling;n.remove();let l=[],f=e.n(i,...t);e.x.connected(()=>w(()=>{let v=f(n,...t);for(;l.length>v.length;)l.pop()[1].map(b=>b.remove());let x=-1;for(let b of v){if(x++,l[x]&&l[x][0]===b)continue;let $=e.f(n.localName=="template"?n.content:n,...t,[c,b]);l[x]?.[1].map(A=>A.remove()),l[x]=[b,$.nodeType==11?[...$.childNodes]:[$]],(l[x-1]?.[1].at(-1)??s).after(...l[x][1])}}))});a.transform(2,(r,t,e,o)=>{if(r.nodeType!=2||r.name!="#if")return;r.ownerElement.before("");let n=r.ownerElement.previousSibling,c=[],i=[],s=n,l=b=>{if(s.nextElementSibling?.hasAttribute(b))return s=s.nextElementSibling,c.push(`()=>(${s.getAttribute(b)})`),i.push(s.localName=="template"?s.content:s),s.removeAttribute(b),!0};for(l("#if");l("#else-if"););for(l("#else")&&(c[c.length-1]="()=>1");n.nextSibling!=s;)n.nextSibling.remove();s.remove();let f,v=e.n(`[${c}].findIndex(e=>e())`,...t),x=[];e.x.connected(()=>w(()=>{let b=v(null,...t);if(b==f||(f=b,x.splice(0).map(A=>A.remove()),!i[b]))return;let $=e.f(i[b],...t);x.push(...$.nodeType==11?$.childNodes:[$]),n.after(...x)}))});a.transform(3,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!=":")return;let n=r.ownerElement,c=r.name.slice(1);n.removeAttribute(r.name);let i=e.n(r.value,...t);e.x.connected(()=>w(()=>{let s=i(n,...t);s==null?n.removeAttribute(c):n.setAttribute(c,s)}))});a.transform(4,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!=".")return;let n=r.ownerElement;n.removeAttribute(r.name);let c=r.name.slice(1).split(".").at(-1),i=r.name.slice(1).split(".").map(y),s=e.n(r.value||!0,...t);e.x.connected(()=>w(()=>{let l=s(n,...t),f=n,v=[...i],x=v.pop();for(let b of v)f=f?.[b];f instanceof DOMTokenList?f.toggle(c,l):f!=null&&(f[x]=l)}))});a.transform(5,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!="@")return;let n=r.ownerElement,c=r.name.slice(1);n.removeAttribute(r.name);let i=e.n(r.value,...t,["event"]);e.x.connected(()=>{d(n).does(c).then(s=>{u.ignore(()=>i(n,...t,["event",s]))})})});self.yozo={monitor:u,until:j,Flow:g,live:p,when:d,purify:F,effect:w,frame:q,interval:O,paint:P,timeout:L};Object.defineProperty(self.yozo,"register",{value:k});})();
