(()=>{var h=Symbol(),m=Symbol(),v=r=>r.replace(/-+(\w)?/g,(t,e="")=>e.toUpperCase()),E=r=>{let t={constructor:null};for(let e of r)for(let o of Object.keys(e))t[o]??=function(...n){r.map(c=>c[o]?.call(this,...n))};return t};var g=class{#t=[];#o=[];#e;#n;#r;constructor(t){l.add("undo",()=>this.stop()),t?.((...e)=>{this.now(...e)})}flow(t){return this.#t.push(t),this}now(...t){let e=-1,o=()=>{this.#e||(e++,!(e<this.#r)&&(this.#n&&(this.#r=e+1),this.#t.length+1==this.#r&&this.stop(),this.#t[e]?.(o,...t)))};return o(),this}then(t){return this.flow((e,...o)=>{t(...o),e()})}await(t){return this.flow(async(e,...o)=>{await t(...o),e()})}if(t){return this.flow((e,...o)=>{t(...o)&&e()})}or(t){return t.then((...e)=>this.now(...e)),this.cleanup(()=>t.stop?.())}stop(){if(!this.#e)return this.#e=!0,this.#t.splice(0),this.#o.splice(0).map(t=>t()),this}until(t){return typeof t=="function"?this.flow((e,...o)=>t(...o)?this.stop():e()):(this.cleanup(()=>t.stop?.()),t.then(()=>this.stop()),this)}cleanup(t){return this.#e?t():this.#o.push(t),this}once(){return this.then(()=>this.#n=!0)}debounce(t){let e;return this.flow(o=>{clearTimeout(e),e=setTimeout(o,t)}).cleanup(()=>clearTimeout(e))}throttle(t){let e,o;return this.flow(n=>{if(o)return e=n;n(),o=setInterval(()=>{if(!e){clearTimeout(o),o=0;return}e(),e=null},t)}).cleanup(()=>clearTimeout(o))}after(t){return queueMicrotask(()=>queueMicrotask(t)),this}};var d=(...r)=>new Proxy({does:(t,e)=>{let o;return new g(n=>{o=n,r.map(c=>c.addEventListener(t,o,e))}).cleanup(()=>r.map(n=>n.removeEventListener(t,o,e)))},observes:(t,e)=>{let o;return new g(n=>{o=new self[v(`-${t}-observer`)](n,e),r.map(c=>o.observe(c,e))}).cleanup(()=>o.disconnect())}},{get:(t,e)=>t[e]??t.does.bind(null,e.replace(/s$/,""))});var w=(r,t=queueMicrotask)=>{let e,o=new g().then(()=>{let n=l(["live","undo"],r);e=l.ignore(()=>d(n.live).change()).once().then(()=>t(()=>o.now())).cleanup(()=>n.undo())}).cleanup(()=>e?.stop());return t(()=>o.now()),o};var p=r=>new k({t:{$:p.get(r)}},"$").e;p[m]=new WeakMap;var O=new WeakMap,k=class{constructor(t,e,o=this){this.r=t,this.c=e,this.h=o,this.a={},this.e=new Proxy(new EventTarget,{get:(n,c)=>c==Symbol.iterator?()=>(l.add("live",this.e,"keychange"),[...this.t].map((s,i)=>this.o(i).e)[Symbol.iterator]()):c[0]=="$"?this.o(c.slice(1)).e:n[c]?n[c].bind(n):(l.add("live",this.o(c).e,"deepchange"),this.t?.[c]),set:(n,c,s)=>p.set(this.o(c).e,s),deleteProperty:(n,c,s)=>p.delete(this.o(c).e),has:(n,c)=>(l.add("live",this.e,"keychange"),this.t!=null&&n[c]||c in this.t),ownKeys:()=>(l.add("live",this.e,"keychange"),Object.keys(this.t??{}).map(n=>`$${n}`)),getOwnPropertyDescriptor:()=>({configurable:!0,enumerable:!0}),defineProperty:()=>!1}),p[m].set(this.e,this),o==this&&O.set(this,new Set),O.get(o).add(new WeakRef(this)),this.t=this.r.t?.[this.c],this.m=Object.keys(this.t??{})}o(t){return this.a[t]??=new k(this,t,this.h)}u(t,e=new Set([this])){let o=t?.(),n=this.t,c=this.r.t?.[this.c];this.t=c,Object.is(n,c)||this.e.dispatchEvent(new CustomEvent("change",{detail:{oldValue:n,value:c}}));let s=Object.keys(this.t??{}),i=new Set(this.m);this.m=s;for(let f of s)i.has(f)?i.delete(f):i.add(f);i.size&&this.e.dispatchEvent(new CustomEvent("keychange",{detail:{keys:[...i]}}));let u=this.r;for(e.add(this);!e.has(u)&&u.r;)u.u(null,e),e.add(u),u=u.r;if(Object.is(n,c))return o;for(let f of Object.values(this.a))f.u(null,e);if(t){for(let f of e)f.e.dispatchEvent(new CustomEvent("deepchange"));return o}}};p.get=(r,t)=>{let e=p[m].get(r);return e?t!=null?e.o(t).t:(l.add("live",r,"deepchange"),e.t):t==null?r:r[t]};p.set=(r,t)=>{let e=p[m].get(r);return!!e?.u(()=>e.r.t==null?!1:(e.r.t[e.c]=p.get(t),!0))};p.delete=(r,t)=>{let e=p[m].get(r);return!!e?.u(()=>e.r.t==null?!1:delete e.r.t[e.c])};p.link=(r,t)=>{let e,o=t;t instanceof HTMLElement?o={get:()=>t.value,set:i=>t.value=i,changes:d(t).input()}:typeof t=="function"&&(o={get:()=>e,changes:w(()=>e=t(),i=>i())});let n,c=i=>{n=!0,p.set(r,i),e=i,n=!1},s=d(r).deepchange().then(()=>{if(!n){if(!o.set)return c(e);o.set(l.ignore(()=>p.get(r))),c(l.ignore(o.get))}});return c(l.ignore(o.get)),(o.changes??new g).then(()=>c(l.ignore(o.get))).if(()=>null).cleanup(()=>s.stop())};var l=(r,t)=>{let e=l[h];l[h]={};let o={};for(let n of r)l[h][n]=new l[m][n],o[n]=l[h][n].result;return o.result=t(),l[h]=e,o},M=r=>{if(!l[h])return r;let t=l[h];return l[h]=null,{then:e=>Promise.resolve(r).then(o=>{Object.keys(t).some(n=>t[n].until?.())||(queueMicrotask(()=>l[h]=t),e(o),queueMicrotask(()=>l[h]=null))})}};l.ignore=r=>l([],r).result;l.add=(r,...t)=>{l[h]?.[r]?.add(...t)};l.register=(r,t)=>{l[m][r]??=t};l[m]={result:!0,undo:class{[m]=[];#t;result=()=>{this.#t||(this[m].splice(0).map(r=>r()),this.#t=!0)};add(r){if(this.#t)return r();this[m].push(r)}until(){return this.#t}},live:class{[m]=new Map;result=new EventTarget;add(r,t){let e=this[m].get(r)??[];e.includes(t)||(e.push(t),this[m].set(r,e),l.ignore(()=>d(r).does(t)).then(()=>this.result.dispatchEvent(new CustomEvent("change"))))}}};var j=r=>{let t;return(...e)=>(t?.undo(),t=l(["undo"],()=>r(...e)),t.result)};var C=r=>{let t;return new g(e=>t=setInterval(e,r)).cleanup(()=>clearInterval(t))},q=r=>C(r).once(),A=()=>{let r;return new g(t=>{let e=()=>r=requestAnimationFrame(o=>{e(),t(o)});e()}).cleanup(()=>cancelAnimationFrame(r))},N=()=>{let r=0;return A().if(()=>r++).once()};var a=r=>{let t={x:new Set(["$","query"]),i:new WeakMap,s:class extends HTMLElement{constructor(){super(),t.i.set(this,{x:{}}),l.ignore(()=>n.constructor.call(this,t.i.get(this)))}}},e={};r(Object.fromEntries(a[m].map(([c,s])=>[s,(...i)=>(e[s]??=[]).push(i)])));let o=a[m].map(([c,s])=>c(t,e[s]??[])),n=E(o);for(let c of Object.keys(n))t.s.prototype[c]??=function(...s){l.ignore(()=>n[c].call(this,t.i.get(this),...s))};return customElements.define(t.p,t.s),customElements.whenDefined(t.p)};a[m]=[];a[h]=[];a.register=(r,t,e)=>{a[m].push([e,t,r]),a[m].sort((o,n)=>o[2]-n[2])};a.transform=(r,t)=>{a[h].push([t,r]),a[h].sort((e,o)=>e[1]-o[1])};var $=async r=>{if($[m].has(`${r}`))return;$[m].add(`${r}`);let t=await fetch(r),e=document.createElement("template");return e.innerHTML=await t.text(),a(o=>{for(let n of e.content.children)o[n.localName]?.(Object.fromEntries([...n.attributes].map(c=>[v(c.name),c.value])),n.innerHTML)})};$[m]=new Set;var F;$.auto=r=>{if($.auto[m])return;$.auto[m]=new Set;let t=o=>{if($.auto[m].has(o))return;$.auto[m].add(o);let n=r(o);n&&$(n)},e=o=>{for(let n of o.querySelectorAll(":not(:defined)"))t(n.localName);for(let n of o.querySelectorAll("template"))e(n.content)};return a.register(6,Symbol(),o=>F?{}:(o.l&&e(o.l),{}),{}),d(document).observes("mutation",{childList:!0,subtree:!0}).then(()=>e(document)).now().if(()=>null).cleanup(()=>F=!0)};a.register(0,"title",(r,[t])=>(r.p=t[1],{}));a.register(1,"meta",(r,t)=>{let e=t.filter(s=>s[0].attribute),o=[...t.filter(s=>s[0].property),...e.filter(s=>s[0].type).map(s=>[{property:s[0].as??v(s[0].attribute)}]),...t.filter(s=>s[0].method).map(s=>[{property:s[0].method,readonly:""}])];for(let[s]of o){let i=function(){return l.ignore(()=>p.get(r.i.get(this).x.$,s.property))},u=function(f){l.ignore(()=>r.i.get(this).x.$[s.property]=f)};Object.defineProperty(r.s.prototype,s.property,"readonly"in s?{get:i}:{get:i,set:u})}return r.s.observedAttributes=e.map(s=>s[0].attribute),r.s.formAssociated=t.some(s=>s[0].formAssociated!=null),{constructor:function(s){s.x.$=p({attributes:{}}),e.map(([i])=>{let u=v(i.attribute);if(s.x.$.$attributes[u]=null,d(s.x.$.$attributes[`$${u}`]).change().then(()=>{let f=p.get(s.x.$.$attributes,u);f==null?this.removeAttribute(i.attribute):this.setAttribute(i.attribute,f)}),i.type=="boolean")p.link(s.x.$[`$${i.as??u}`],{get:()=>p.get(s.x.$.$attributes,u)!=null,set:f=>s.x.$.$attributes[u]=f?"":null,changes:d(s.x.$.$attributes[`$${u}`]).change()});else if(i.type){let f=self[v(`-${i.type}`)];p.link(s.x.$[`$${i.as??u}`],{get:()=>f(p.get(s.x.$.$attributes,u)??i.default??""),set:y=>s.x.$.$attributes[u]=y==null?null:`${y}`,changes:d(s.x.$.$attributes[`$${u}`]).change()})}}),o.map(([{property:i}])=>{if(!Object.hasOwn(this,i))return;let u=this[i];delete this[i],this[i]=u})},attributeChangedCallback:function(s,i,u,f){s.x.$.$attributes[v(i)]=f}}});a.register(2,"meta",(r,t)=>E([...t,[{hook:"connected",unhook:"disconnected"}],[{hook:"disconnected"}]].map(e=>{let{hook:o,unhook:n}=e[0];if(!o)return{};r.x.add(o);let c=function(i){i.x[o]=u=>{let f=[new g().then((...y)=>{f[1]?.undo(),f[1]=l(["undo"],()=>u?.(...y))}).cleanup(()=>{f[1]?.undo(),i.x[o][m].delete(f)})];return i.x[o][m].add(f),i.x[o][h]&&queueMicrotask(()=>f[0].now(...i.x[o][h])),f[0]},i.x[o][m]=new Set},s=function(i,...u){i.x[o][h]=u;for(let f of i.x[o][m])f[0].now(...u)};return n?{constructor:c,[`${o}Callback`]:s,[`${n}Callback`]:function(i,...u){i.x[o][h]=null;for(let f of i.x[o][m])f[1]?.undo()}}:{constructor:c,[`${o}Callback`]:s}})));a.register(3,Symbol(),r=>({constructor:function(e){e.n=(o,...n)=>{let c=n.map(()=>`$${v(crypto.randomUUID())}`),s=new Function(...c,`var ${n.map((i,u)=>`${i[0]}=${c[u]}`)};return(${o})`);return(i,...u)=>s.call(i,...u.map(f=>f[1]))},e.f=(o,...n)=>l.ignore(()=>{let c=o.cloneNode(!0),s=document.createNodeIterator(c,5),i;t:for(;i=s.nextNode();){if(i.nodeType==1){for(let[u]of a[h])for(let f of[...i.attributes])if(u(f,n,e,r),s.referenceNode!=i)continue t}for(let[u]of a[h])if(u(i,n,e,r),s.referenceNode!=i)continue t}return c})}}));a.register(5,"template",(r,[t])=>{if(!t)return{constructor:function(o){o.root=this}};let e=document.createElement("template");return e.innerHTML=t[1],r.l=e.content,t[0].mode?{constructor:function(o){o.root=this.attachShadow(t[0]),o.root.append(o.f(r.l,[`{${[...r.x]}}`,o.x])),customElements.upgrade(o.root)}}:{constructor:function(o){o.root=o.f(r.l,[`{${[...r.x]}}`,o.x]),customElements.upgrade(o.root)},connectedCallback:function(o){o.root!=this&&(this.replaceChildren(o.root),o.root=this)}}});a.register(7,Symbol(),r=>({constructor:function(e){e.x.query=o=>e.root.querySelector(o),e.x.query.all=o=>[...e.root.querySelectorAll(o)]}}));a.register(8,"style",(r,[t])=>{if(!t)return{};let e=new CSSStyleSheet;return e.replace(t[1]),{connectedCallback:function(o){let n=o.root.mode?o.root:this.getRootNode(),c=n.adoptedStyleSheets;c.includes(e)||(n.adoptedStyleSheets=[...c,e])}}});a.register(10,"script",(r,[t])=>{if(!t)return{};let e=new Function(`{${[...r.x]}}`,`const{${Object.keys(self.yozo)}}=self.yozo;${t[1]}`);return{constructor:function(o){e.call(this,o.x)}}});a.transform(0,(r,t,e,o)=>{if(r.nodeType!=3)return;let n=r.textContent.split(/{{([^]*?)}}/g);r.before(...n);let c=r;for(let s=1;s<n.length;s+=2){c=c.previousSibling.previousSibling;let i=c,u=e.n(i.textContent,...t);e.x.connected(()=>w(()=>{i.textContent=u(null,...t)}))}r.remove()});a.transform(1,(r,t,e,o)=>{if(r.nodeType!=2||r.name!="#for")return;let n=r.ownerElement;n.removeAttribute(r.name);let[c,s]=r.value.split(" of ");n.before("");let i=n.previousSibling;n.remove();let u=[],f=e.n(s,...t);e.x.connected(()=>w(()=>{let y=f(n,...t);for(;u.length>y.length;)u.pop()[1].map(b=>b.remove());let x=-1;for(let b of y){if(x++,u[x]&&u[x][0]===b)continue;let S=e.f(n.localName=="template"?n.content:n,...t,[c,b]);u[x]?.[1].map(T=>T.remove()),u[x]=[b,S.nodeType==11?[...S.childNodes]:[S]],(u[x-1]?.[1].at(-1)??i).after(...u[x][1])}}))});a.transform(2,(r,t,e,o)=>{if(r.nodeType!=2||r.name!="#if")return;r.ownerElement.before("");let n=r.ownerElement.previousSibling,c=[],s=[],i=n,u=b=>{if(i.nextElementSibling?.hasAttribute(b))return i=i.nextElementSibling,c.push(`()=>(${i.getAttribute(b)||!0})`),s.push(i.localName=="template"?i.content:i),i.removeAttribute(b),!0};for(u("#if");u("#else-if"););for(u("#else");n.nextSibling!=i;)n.nextSibling.remove();i.remove();let f,y=e.n(`[${c}].findIndex(e=>e())`,...t),x=[];e.x.connected(()=>w(()=>{let b=y(null,...t);if(b==f||(f=b,x.splice(0).map(T=>T.remove()),!s[b]))return;let S=e.f(s[b],...t);x.push(...S.nodeType==11?S.childNodes:[S]),n.after(...x)}))});a.transform(3,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!=":")return;let n=r.ownerElement,c=r.name.slice(1);n.removeAttribute(r.name);let s=e.n(r.value,...t);e.x.connected(()=>w(()=>{let i=s(n,...t);i==null?n.removeAttribute(c):n.setAttribute(c,i)}))});a.transform(4,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!=".")return;let n=r.ownerElement;n.removeAttribute(r.name);let c=r.name.slice(1).split(".").at(-1),s=r.name.slice(1).split(".").map(v),i=e.n(r.value||!0,...t);e.x.connected(()=>w(()=>{let u=i(n,...t),f=n,y=[...s],x=y.pop();for(let b of y)f=f?.[b];f!=null&&(f instanceof DOMTokenList?f.toggle(c,u):f[x]=u)}))});a.transform(5,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!="@")return;let n=r.ownerElement,c=r.name.slice(1);n.removeAttribute(r.name);let s=e.n(r.value,...t,["event"]);e.x.connected(()=>d(n).does(c).then(i=>{l.ignore(()=>s(n,...t,["event",i]))}))});self.yozo={monitor:l,until:M,Flow:g,live:p,when:d,purify:j,effect:w,frame:A,interval:C,paint:N,timeout:q};Object.defineProperty(self.yozo,"register",{value:$});})();
