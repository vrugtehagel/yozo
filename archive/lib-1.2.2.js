(()=>{var h=Symbol(),m=Symbol(),v=r=>r.replace(/-+(\w)?/g,(t,e="")=>e?.toUpperCase()),A=r=>r.replace(/[A-Z]/g,"-$&").toLowerCase(),E=r=>{let t={constructor:null};for(let e of r)for(let o of Object.keys(e))t[o]??=function(...n){r.map(s=>s[o]?.call(this,...n))};return t};var g=class{#t=[];#o=[];#e;#n;#r;constructor(t){u.add("undo",()=>this.stop()),t?.((...e)=>{this.now(...e)})}flow(t){return this.#t.push(t),this}now(...t){let e=-1,o=()=>{this.#e||(e++,!(e<this.#r)&&(this.#n&&(this.#r=e+1),this.#t.length+1==this.#r&&this.stop(),this.#t[e]?.(o,...t)))};return o(),this}then(t){return this.flow((e,...o)=>{t(...o),e()})}await(t){return this.flow(async(e,...o)=>{await t(...o),e()})}if(t){return this.flow((e,...o)=>{t(...o)&&e()})}or(t){return t.then((...e)=>this.now(...e)),this.cleanup(()=>t.stop?.())}stop(){if(!this.#e)return this.#e=!0,this.#t.splice(0),this.#o.splice(0).map(t=>t()),this}until(t){return typeof t=="function"?this.flow((e,...o)=>t(...o)?this.stop():e()):(this.cleanup(()=>t.stop?.()),t.then(()=>this.stop()),this)}cleanup(t){return this.#e?t():this.#o.push(t),this}once(){return this.then(()=>this.#n=!0)}debounce(t){let e;return this.flow(o=>{clearTimeout(e),e=setTimeout(o,t)}).cleanup(()=>clearTimeout(e))}throttle(t){let e,o;return this.flow(n=>{if(o)return e=n;n(),o=setInterval(()=>{if(!e){clearTimeout(o),o=0;return}e(),e=null},t)}).cleanup(()=>clearTimeout(o))}after(t){return queueMicrotask(()=>queueMicrotask(t)),this}};var d=(...r)=>new Proxy({does:(t,e)=>{let o;return new g(n=>{o=n,r.map(s=>s.addEventListener(t,o,e))}).cleanup(()=>r.map(n=>n.removeEventListener(t,o,e)))},observes:(t,e)=>{let o;return new g(n=>{o=new self[v(`-${t}-observer`)](n,e),r.map(s=>o.observe(s,e))}).cleanup(()=>o.disconnect())}},{get:(t,e)=>t[e]??t.does.bind(null,e.replace(/s$/,""))});var w=(r,t=queueMicrotask)=>{let e,o=new g;return o.then(()=>{let n=u(["live","undo"],r);e=u.ignore(()=>d(n.live).change()).once().then(()=>t(()=>o.now())).cleanup(()=>n.undo())}).cleanup(()=>e?.stop()),t(()=>o.now()),o};var p=r=>new S({t:{$:p.get(r)}},"$").e;p[m]=new WeakMap;var j=new WeakMap,S=class{constructor(t,e,o=this){this.r=t,this.c=e,this.h=o,this.a={},this.e=new Proxy(new EventTarget,{get:(n,s)=>s==Symbol.iterator?()=>(u.add("live",this.e,"keychange"),[...this.t].map((i,c)=>this.o(c).e)[Symbol.iterator]()):s[0]=="$"?this.o(s.slice(1)).e:n[s]?n[s].bind(n):(u.add("live",this.o(s).e,"deepchange"),this.t?.[s]),set:(n,s,i)=>p.set(this.o(s).e,i),deleteProperty:(n,s,i)=>p.delete(this.o(s).e),has:(n,s)=>(u.add("live",this.e,"keychange"),this.t!=null&&n[s]||s in this.t),ownKeys:()=>(u.add("live",this.e,"keychange"),Object.keys(this.t??{}).map(n=>`$${n}`)),getOwnPropertyDescriptor:()=>({configurable:!0,enumerable:!0}),defineProperty:()=>!1}),p[m].set(this.e,this),o==this&&j.set(this,new Set),j.get(o).add(new WeakRef(this)),this.t=this.r.t?.[this.c],this.m=Object.keys(this.t??{})}o(t){return this.a[t]??=new S(this,t,this.h)}l(t,e=new Set([this])){let o=t?.(),n=this.t,s=this.r.t?.[this.c];this.t=s,Object.is(n,s)||this.e.dispatchEvent(new CustomEvent("change",{detail:{oldValue:n,value:s}}));let i=Object.keys(this.t??{}),c=new Set(this.m);this.m=i;for(let f of i)c.has(f)?c.delete(f):c.add(f);c.size&&this.e.dispatchEvent(new CustomEvent("keychange",{detail:{keys:[...c]}}));let l=this.r;for(e.add(this);!e.has(l)&&l.r;)l.l(null,e),e.add(l),l=l.r;if(Object.is(n,s))return o;for(let f of Object.values(this.a))f.l(null,e);if(t){for(let f of e)f.e.dispatchEvent(new CustomEvent("deepchange"));return o}}};p.get=(r,t)=>{let e=p[m].get(r);return e?t!=null?e.o(t).t:(u.add("live",r,"deepchange"),e.t):t==null?r:r[t]};p.set=(r,t)=>{let e=p[m].get(r);return!!e?.l(()=>e.r.t==null?!1:(e.r.t[e.c]=p.get(t),!0))};p.delete=(r,t)=>{let e=p[m].get(r);return!!e?.l(()=>e.r.t==null?!1:delete e.r.t[e.c])};p.link=(r,t)=>{let e,o=t;t instanceof HTMLElement?o={get:()=>t.value,set:c=>t.value=c,changes:d(t).input()}:typeof t=="function"&&(o={get:()=>e,changes:w(()=>e=t(),c=>c())});let n,s=c=>{n=!0,p.set(r,c),e=c,n=!1},i=d(r).deepchange().then(()=>{if(!n){if(!o.set)return s(e);o.set(u.ignore(()=>p.get(r))),s(u.ignore(o.get))}});return s(u.ignore(o.get)),(o.changes??new g).then(()=>s(u.ignore(o.get))).if(()=>null).cleanup(()=>i.stop())};var u=(r,t)=>{let e=u[h];u[h]={};let o={};for(let n of r)o[n]=(u[h][n]=new u[m][n]).result;return o.result=t(),u[h]=e,o},N=r=>{if(!u[h])return r;let t=u[h];return u[h]=null,{then:e=>Promise.resolve(r).then(o=>{Object.keys(t).some(n=>t[n].until?.())||(queueMicrotask(()=>u[h]=t),e(o),queueMicrotask(()=>u[h]=null))})}};u.ignore=r=>u([],r).result;u.add=(r,...t)=>{u[h]?.[r]?.add(...t)};u[m]={result:!0};u.register=(r,t)=>{u[m][r]||(u[m][r]??=t)};u.register("undo",class{[m]=[];#t;result=()=>{this.#t||(this[m].splice(0).map(r=>r()),this.#t=!0)};add(r){if(this.#t)return r();this[m].push(r)}until(){return this.#t}});u.register("live",class{[m]=new Map;result=new EventTarget;add(r,t){let e=this[m].get(r)??[];e.includes(t)||(e.push(t),this[m].set(r,e),u.ignore(()=>d(r).does(t)).then(()=>this.result.dispatchEvent(new CustomEvent("change"))))}});var q=r=>{let t;return(...e)=>(t?.undo(),t=u(["undo"],()=>r(...e)),t.result)};var O=r=>{let t;return new g(e=>t=setInterval(e,r)).cleanup(()=>clearInterval(t))},F=r=>O(r).once(),M=()=>{let r;return new g(t=>{let e=()=>r=requestAnimationFrame(o=>{e(),t(o)});e()}).cleanup(()=>cancelAnimationFrame(r))},L=()=>{let r=0;return M().if(()=>r++).once()};var a=r=>{let t={x:new Set,i:new WeakMap,s:class extends HTMLElement{constructor(){super(),t.i.set(this,{x:{}}),u.ignore(()=>n.constructor.call(this,t.i.get(this)))}}},e={};r(Object.fromEntries(a[m].map(([s,i])=>[i,(...c)=>(e[i]??=[]).push(c)])));let o=a[m].map(([s,i])=>s(t,e[i]??[])),n=E(o);for(let s of Object.keys(n))t.s.prototype[s]??=function(...i){u.ignore(()=>n[s].call(this,t.i.get(this),...i))};return customElements.define(t.p,t.s),customElements.whenDefined(t.p)};a[m]=[];a[h]=[];a.register=(r,t,e)=>{a[m].push([e,t,r]),a[m].sort((o,n)=>o[2]-n[2])};a.transform=(r,t)=>{a[h].push([t,r]),a[h].sort((e,o)=>e[1]-o[1])};var k=async r=>{if(k[m].has(`${r}`))return;k[m].add(`${r}`);let t=await fetch(r),e=document.createElement("template");return e.innerHTML=await t.text(),a(o=>{for(let n of e.content.children)o[n.localName]?.(Object.fromEntries([...n.attributes].map(s=>[v(s.name),s.value])),n.innerHTML)})};k[m]=new Set;var C,P;k.auto=r=>{if(C)return;C=new Set;let t=o=>{if(C.has(o))return;C.add(o);let n=r(o);n&&k(n)},e=o=>{for(let n of o.querySelectorAll(":not(:defined)"))t(n.localName);for(let n of o.querySelectorAll("template"))e(n.content)};return a.register(6,null,o=>P?{}:o.u?(e(o.u),{}):{},{}),d(document).observes("mutation",{childList:!0,subtree:!0}).then(()=>e(document)).now().if(()=>null).cleanup(()=>P=!0)};a.register(0,"title",(r,[t])=>(r.p=t?.[1],{}));a.register(1,"meta",(r,t)=>{r.x.add("$");let e=t.filter(i=>i[0].attribute),o=[...t.filter(i=>i[0].property),...e.filter(i=>i[0].type).map(i=>[{property:i[0].as??v(i[0].attribute)}]),...t.filter(i=>i[0].method).map(i=>[{property:i[0].method,readonly:""}])];for(let[i]of o){let c=function(){return u.ignore(()=>p.get(r.i.get(this).x.$,i.property))},l=function(f){u.ignore(()=>r.i.get(this).x.$[i.property]=f)};Object.defineProperty(r.s.prototype,i.property,"readonly"in i?{get:c}:{get:c,set:l})}return r.s.observedAttributes=e.map(i=>i[0].attribute),r.s.formAssociated=t.some(i=>i[0].formAssociated!=null),{constructor:function(i){i.x.$=p({attributes:{}}),i.x.$.attributes={};for(let[c]of e){let l=v(c.attribute);if(i.x.$.$attributes[l]=null,d(i.x.$.$attributes[`$${l}`]).change().then(()=>{let f=p.get(i.x.$.$attributes,l);f==null?this.removeAttribute(c.attribute):this.setAttribute(c.attribute,f)}),c.type=="boolean")p.link(i.x.$[`$${c.as??l}`],{get:()=>p.get(i.x.$.$attributes,l)!=null,set:f=>i.x.$.$attributes[l]=f?"":null,changes:d(i.x.$.$attributes[`$${l}`]).change()});else if(c.type){let f=self[v(`-${c.type}`)];p.link(i.x.$[`$${c.as??l}`],{get:()=>f(p.get(i.x.$.$attributes,l)??c.default??""),set:y=>i.x.$.$attributes[l]=y==null?null:`${y}`,changes:d(i.x.$.$attributes[`$${l}`]).change()})}}for(let[{property:c}]of o){if(!Object.hasOwn(this,c))continue;let l=this[c];delete this[c],this[c]=l}},attributeChangedCallback:function(i,c,l,f){i.x.$.$attributes[v(c)]=f}}});a.register(2,"meta",(r,t)=>E([...t,[{hook:"connected",unhook:"disconnected"}],[{hook:"disconnected"}]].filter(e=>e[0].hook).map(e=>{let{hook:o,unhook:n}=e[0];r.x.add(o);let s=function(c){c.x[o]=l=>{let f=[new g().then((...y)=>{f[1]?.undo(),f[1]=u(["undo"],()=>l?.(...y))}).cleanup(()=>{f[1]?.undo(),c.x[o][m].delete(f)})];return c.x[o][m].add(f),c.x[o][h]&&queueMicrotask(()=>f[0].now(...c.x[o][h])),f[0]},c.x[o][m]=new Set},i=function(c,...l){c.x[o][h]=l;for(let f of c.x[o][m])f[0].now(...l)};return n?{constructor:s,[`${o}Callback`]:i,[`${n}Callback`]:function(c,...l){c.x[o][h]=null;for(let f of c.x[o][m])f[1]?.undo()}}:{constructor:s,[`${o}Callback`]:i}})));a.register(3,Symbol(),r=>({constructor:function(e){e.n=(o,...n)=>{let s=n.map(()=>`$${v(crypto.randomUUID())}`),i=new Function(...s,`var ${n.map((c,l)=>`${c[0]}=${s[l]}`)};return(${o})`);return(c,...l)=>i.call(c,...l.map(f=>f[1]))},e.f=(o,...n)=>u.ignore(()=>{let s=o.cloneNode(!0),i=document.createNodeIterator(s,5),c;t:for(;c=i.nextNode();){if(c.nodeType==1){for(let[l]of a[h])for(let f of[...c.attributes])if(l(f,n,e,r),i.referenceNode!=c)continue t}for(let[l]of a[h])if(l(c,n,e,r),i.referenceNode!=c)continue t}return s})}}));a.register(5,"template",(r,[t])=>{if(!t)return{constructor:function(i){i.root=this}};let e=document.createElement("template");return e.innerHTML=t[1],r.u=e.content,t[0].mode?{constructor:function(i){i.root=this.attachShadow(t[0]),i.root.append(i.f(r.u,[`{${[...r.x]}}`,i.x])),customElements.upgrade(i.root)}}:{constructor:function(s){s.root=s.f(r.u,[`{${[...r.x]}}`,s.x]),customElements.upgrade(s.root)},connectedCallback:function(s){s.root!=this&&(this.replaceChildren(s.root),s.root=this)}}});a.register(7,Symbol(),r=>(r.x.add("elements"),{constructor:function(e){let o={all:n=>[...e.root.querySelectorAll(n)],shadow:e.root.mode?e.root:null};e.x.elements=new Proxy(n=>e.root.querySelector(n),{get:(n,s)=>o[s]??=n(`#${A(s)},#${s}`)??n(A(s))})}}));a.register(8,"style",(r,[t])=>{if(!t)return{};let e=new CSSStyleSheet;return e.replace(t[1]),{connectedCallback:function(n){let s=n.x.elements.shadow??this.getRootNode(),i=s.adoptedStyleSheets;i.includes(e)||(s.adoptedStyleSheets=[...i,e])}}});a.register(10,"script",(r,[t])=>{if(!t)return{};let e=new Function(`{${[...r.x]}}`,`const{${Object.keys(self.yozo)}}=self.yozo;${t[1]}`);return{constructor:function(n){e.call(this,n.x)}}});a.transform(0,(r,t,e,o)=>{if(r.nodeType!=3)return;let n=r.textContent.split(/{{([^]*?)}}/g);r.before(...n);let s=r;for(let i=1;i<n.length;i+=2){s=s.previousSibling.previousSibling;let c=s,l=e.n(c.textContent,...t);e.x.connected(()=>w(()=>{c.textContent=l(null,...t)}))}r.remove()});a.transform(1,(r,t,e,o)=>{if(r.nodeType!=2||r.name!="#for")return;let n=r.ownerElement;n.removeAttribute(r.name);let[s,i]=r.value.split(" of ");n.before("");let c=n.previousSibling;n.remove();let l=[],f=e.n(i,...t);e.x.connected(()=>w(()=>{let y=f(n,...t);for(;l.length>y.length;)l.pop()[1].map(b=>b.remove());let x=-1;for(let b of y){if(x++,l[x]&&l[x][0]===b)continue;let $=e.f(n.localName=="template"?n.content:n,...t,[s,b]);l[x]?.[1].map(T=>T.remove()),l[x]=[b,$.nodeType==11?[...$.childNodes]:[$]],(l[x-1]?.[1].at(-1)??c).after(...l[x][1])}}))});a.transform(2,(r,t,e,o)=>{if(r.nodeType!=2||r.name!="#if")return;r.ownerElement.before("");let n=r.ownerElement.previousSibling,s=[],i=[],c=n,l=b=>{if(c.nextElementSibling?.hasAttribute(b))return c=c.nextElementSibling,s.push(`()=>(${c.getAttribute(b)})`),i.push(c.localName=="template"?c.content:c),c.removeAttribute(b),!0};for(l("#if");l("#else-if"););for(l("#else")&&(s[s.length-1]="()=>1");n.nextSibling!=c;)n.nextSibling.remove();c.remove();let f,y=e.n(`[${s}].findIndex(e=>e())`,...t),x=[];e.x.connected(()=>w(()=>{let b=y(null,...t);if(b==f||(f=b,x.splice(0).map(T=>T.remove()),!i[b]))return;let $=e.f(i[b],...t);x.push(...$.nodeType==11?$.childNodes:[$]),n.after(...x)}))});a.transform(3,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!=":")return;let n=r.ownerElement,s=r.name.slice(1);n.removeAttribute(r.name);let i=e.n(r.value,...t);e.x.connected(()=>w(()=>{let c=i(n,...t);c==null?n.removeAttribute(s):n.setAttribute(s,c)}))});a.transform(4,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!=".")return;let n=r.ownerElement;n.removeAttribute(r.name);let s=r.name.slice(1).split(".").at(-1),i=r.name.slice(1).split(".").map(v),c=e.n(r.value||!0,...t);e.x.connected(()=>w(()=>{let l=c(n,...t),f=n,y=[...i],x=y.pop();for(let b of y)f=f?.[b];f instanceof DOMTokenList?f.toggle(s,l):f!=null&&(f[x]=l)}))});a.transform(5,(r,t,e,o)=>{if(r.nodeType!=2||r.name[0]!="@")return;let n=r.ownerElement,s=r.name.slice(1);n.removeAttribute(r.name);let i=e.n(r.value,...t,["event"]);e.x.connected(()=>{d(n).does(s).then(c=>{u.ignore(()=>i(n,...t,["event",c]))})})});self.yozo={monitor:u,until:N,Flow:g,live:p,when:d,purify:q,effect:w,frame:M,interval:O,paint:L,timeout:F};Object.defineProperty(self.yozo,"register",{value:k});})();
